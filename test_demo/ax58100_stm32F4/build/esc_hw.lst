ARM GAS  /tmp/ccmcY0fn.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"esc_hw.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.esc_address,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	esc_address:
  26              	.LVL0:
  27              	.LFB130:
  28              		.file 1 "Drivers/ESC/AX58100/esc_hw.c"
   1:Drivers/ESC/AX58100/esc_hw.c **** /*
   2:Drivers/ESC/AX58100/esc_hw.c ****  * Licensed under the GNU General Public License version 2 with exceptions. See
   3:Drivers/ESC/AX58100/esc_hw.c ****  * LICENSE file in the project root for full license information
   4:Drivers/ESC/AX58100/esc_hw.c ****  */
   5:Drivers/ESC/AX58100/esc_hw.c **** 
   6:Drivers/ESC/AX58100/esc_hw.c **** /** \file
   7:Drivers/ESC/AX58100/esc_hw.c ****  * \brief
   8:Drivers/ESC/AX58100/esc_hw.c ****  * ESC hardware layer functions.
   9:Drivers/ESC/AX58100/esc_hw.c ****  *
  10:Drivers/ESC/AX58100/esc_hw.c ****  * Function to read and write commands to the ESC. Used to read/write ESC
  11:Drivers/ESC/AX58100/esc_hw.c ****  * registers and memory.
  12:Drivers/ESC/AX58100/esc_hw.c ****  */
  13:Drivers/ESC/AX58100/esc_hw.c **** 
  14:Drivers/ESC/AX58100/esc_hw.c **** #include <string.h>
  15:Drivers/ESC/AX58100/esc_hw.c **** #include "esc.h"
  16:Drivers/ESC/AX58100/esc_hw.c **** #include "ecatapp.h"
  17:Drivers/ESC/AX58100/esc_hw.c **** 
  18:Drivers/ESC/AX58100/esc_hw.c **** #include "main.h"
  19:Drivers/ESC/AX58100/esc_hw.c **** 
  20:Drivers/ESC/AX58100/esc_hw.c **** #define MAX_READ_SIZE 128
  21:Drivers/ESC/AX58100/esc_hw.c **** 
  22:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_CMD_READ 0x02
  23:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_CMD_READWS 0x03
  24:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_CMD_WRITE 0x04
  25:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_CMD_NOP 0x00
  26:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_TERM 0xff
  27:Drivers/ESC/AX58100/esc_hw.c **** #define ESC_NEXT 0x00
  28:Drivers/ESC/AX58100/esc_hw.c **** 
  29:Drivers/ESC/AX58100/esc_hw.c **** #define ESCREG_PDI_CONTROL 0x0140
  30:Drivers/ESC/AX58100/esc_hw.c **** #define ESCREG_ESC_CONFIG 0x0141
ARM GAS  /tmp/ccmcY0fn.s 			page 2


  31:Drivers/ESC/AX58100/esc_hw.c **** #define DC_SYNC_OUT 0x04
  32:Drivers/ESC/AX58100/esc_hw.c **** #define ESCREG_CYCLIC_UNIT_CONTROL 0x0980
  33:Drivers/ESC/AX58100/esc_hw.c **** #define SYNC_OUT_UNIT_CONTROL_MASK 0x01
  34:Drivers/ESC/AX58100/esc_hw.c **** #define SYNC_OUT_ECAT_CONTROL 0x00
  35:Drivers/ESC/AX58100/esc_hw.c **** #define SYNC_OUT_PDI_CONTROL 0x01
  36:Drivers/ESC/AX58100/esc_hw.c **** #define ESCREG_SYNC0_CYCLE_TIME 0x09A0
  37:Drivers/ESC/AX58100/esc_hw.c **** #define ESCREG_SYNC_START_TIME 0x0990
  38:Drivers/ESC/AX58100/esc_hw.c **** // measured with 21MHz SPI PDI
  39:Drivers/ESC/AX58100/esc_hw.c **** #define SYNC_START_OFFSET 2342840
  40:Drivers/ESC/AX58100/esc_hw.c **** 
  41:Drivers/ESC/AX58100/esc_hw.c **** static uint8_t read_termination[MAX_READ_SIZE] = {0};
  42:Drivers/ESC/AX58100/esc_hw.c **** 
  43:Drivers/ESC/AX58100/esc_hw.c **** #define GPIO_ECAT_RESET 1 /* specific function to hold ESC reset on startup \
  44:Drivers/ESC/AX58100/esc_hw.c ****                            * when emulating EEPROM                          \
  45:Drivers/ESC/AX58100/esc_hw.c ****                            */
  46:Drivers/ESC/AX58100/esc_hw.c **** 
  47:Drivers/ESC/AX58100/esc_hw.c **** extern SPI_HandleTypeDef hspi2;
  48:Drivers/ESC/AX58100/esc_hw.c **** 
  49:Drivers/ESC/AX58100/esc_hw.c **** static void esc_address(uint16_t address, uint8_t command)
  50:Drivers/ESC/AX58100/esc_hw.c **** {
  29              		.loc 1 50 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 8
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		.loc 1 50 1 is_stmt 0 view .LVU1
  34 0000 10B5     		push	{r4, lr}
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 4, -8
  37              		.cfi_offset 14, -4
  38 0002 84B0     		sub	sp, sp, #16
  39              		.cfi_def_cfa_offset 24
  51:Drivers/ESC/AX58100/esc_hw.c ****     /* Device is selected already.
  52:Drivers/ESC/AX58100/esc_hw.c ****      * We use 2 bytes addressing.
  53:Drivers/ESC/AX58100/esc_hw.c ****      */
  54:Drivers/ESC/AX58100/esc_hw.c ****     uint8_t data[2];
  40              		.loc 1 54 5 is_stmt 1 view .LVU2
  55:Drivers/ESC/AX58100/esc_hw.c **** 
  56:Drivers/ESC/AX58100/esc_hw.c ****     /* address 12:5 */
  57:Drivers/ESC/AX58100/esc_hw.c ****     data[0] = (address >> 5);
  41              		.loc 1 57 5 view .LVU3
  42              		.loc 1 57 13 is_stmt 0 view .LVU4
  43 0004 4309     		lsrs	r3, r0, #5
  44 0006 8DF80C30 		strb	r3, [sp, #12]
  58:Drivers/ESC/AX58100/esc_hw.c ****     /* address 4:0 and cmd 2:0 */
  59:Drivers/ESC/AX58100/esc_hw.c ****     data[1] = ((address & 0x1F) << 3) | command;
  45              		.loc 1 59 5 is_stmt 1 view .LVU5
  46              		.loc 1 59 39 is_stmt 0 view .LVU6
  47 000a 41EAC000 		orr	r0, r1, r0, lsl #3
  48              	.LVL1:
  49              		.loc 1 59 13 view .LVU7
  50 000e 8DF80D00 		strb	r0, [sp, #13]
  60:Drivers/ESC/AX58100/esc_hw.c **** 
  61:Drivers/ESC/AX58100/esc_hw.c ****     /* Write (and read AL interrupt register) */
  62:Drivers/ESC/AX58100/esc_hw.c ****     HAL_SPI_TransmitReceive(&hspi2, data, (uint8_t *)&ESCvar.ALevent, sizeof(data), 100);
  51              		.loc 1 62 5 is_stmt 1 view .LVU8
  52 0012 084C     		ldr	r4, .L3
  53 0014 6423     		movs	r3, #100
ARM GAS  /tmp/ccmcY0fn.s 			page 3


  54 0016 0093     		str	r3, [sp]
  55 0018 0223     		movs	r3, #2
  56 001a 2246     		mov	r2, r4
  57 001c 03A9     		add	r1, sp, #12
  58              	.LVL2:
  59              		.loc 1 62 5 is_stmt 0 view .LVU9
  60 001e 0648     		ldr	r0, .L3+4
  61 0020 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
  62              	.LVL3:
  63:Drivers/ESC/AX58100/esc_hw.c **** 
  64:Drivers/ESC/AX58100/esc_hw.c ****     ESCvar.ALevent = etohs(ESCvar.ALevent);
  63              		.loc 1 64 5 is_stmt 1 view .LVU10
  64              		.loc 1 64 22 is_stmt 0 view .LVU11
  65 0024 2246     		mov	r2, r4
  66 0026 32F8DC39 		ldrh	r3, [r2], #-220
  67 002a 9BB2     		uxth	r3, r3
  68              		.loc 1 64 20 view .LVU12
  69 002c A2F8DC30 		strh	r3, [r2, #220]	@ movhi
  65:Drivers/ESC/AX58100/esc_hw.c **** }
  70              		.loc 1 65 1 view .LVU13
  71 0030 04B0     		add	sp, sp, #16
  72              		.cfi_def_cfa_offset 8
  73              		@ sp needed
  74 0032 10BD     		pop	{r4, pc}
  75              	.L4:
  76              		.align	2
  77              	.L3:
  78 0034 DC000000 		.word	ESCvar+220
  79 0038 00000000 		.word	hspi2
  80              		.cfi_endproc
  81              	.LFE130:
  83              		.section	.text.ESC_read,"ax",%progbits
  84              		.align	1
  85              		.global	ESC_read
  86              		.syntax unified
  87              		.thumb
  88              		.thumb_func
  90              	ESC_read:
  91              	.LVL4:
  92              	.LFB131:
  66:Drivers/ESC/AX58100/esc_hw.c **** 
  67:Drivers/ESC/AX58100/esc_hw.c **** /** ESC read function used by the Slave stack.
  68:Drivers/ESC/AX58100/esc_hw.c ****  *
  69:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   address     = address of ESC register to read
  70:Drivers/ESC/AX58100/esc_hw.c ****  * @param[out]  buf         = pointer to buffer to read in
  71:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   len         = number of bytes to read
  72:Drivers/ESC/AX58100/esc_hw.c ****  */
  73:Drivers/ESC/AX58100/esc_hw.c **** void ESC_read(uint16_t address, void *buf, uint16_t len)
  74:Drivers/ESC/AX58100/esc_hw.c **** {
  93              		.loc 1 74 1 is_stmt 1 view -0
  94              		.cfi_startproc
  95              		@ args = 0, pretend = 0, frame = 0
  96              		@ frame_needed = 0, uses_anonymous_args = 0
  75:Drivers/ESC/AX58100/esc_hw.c ****     if (len > MAX_READ_SIZE)
  97              		.loc 1 75 5 view .LVU15
  98              		.loc 1 75 8 is_stmt 0 view .LVU16
  99 0000 802A     		cmp	r2, #128
ARM GAS  /tmp/ccmcY0fn.s 			page 4


 100 0002 00D9     		bls	.L11
 101 0004 7047     		bx	lr
 102              	.L11:
  74:Drivers/ESC/AX58100/esc_hw.c ****     if (len > MAX_READ_SIZE)
 103              		.loc 1 74 1 view .LVU17
 104 0006 F0B5     		push	{r4, r5, r6, r7, lr}
 105              		.cfi_def_cfa_offset 20
 106              		.cfi_offset 4, -20
 107              		.cfi_offset 5, -16
 108              		.cfi_offset 6, -12
 109              		.cfi_offset 7, -8
 110              		.cfi_offset 14, -4
 111 0008 83B0     		sub	sp, sp, #12
 112              		.cfi_def_cfa_offset 32
 113 000a 0646     		mov	r6, r0
 114 000c 0D46     		mov	r5, r1
 115 000e 1446     		mov	r4, r2
  76:Drivers/ESC/AX58100/esc_hw.c ****     {
  77:Drivers/ESC/AX58100/esc_hw.c ****         return;
  78:Drivers/ESC/AX58100/esc_hw.c ****     }
  79:Drivers/ESC/AX58100/esc_hw.c **** 
  80:Drivers/ESC/AX58100/esc_hw.c ****     /* Select device. */
  81:Drivers/ESC/AX58100/esc_hw.c ****     // spi_select (et1100);
  82:Drivers/ESC/AX58100/esc_hw.c ****     HAL_GPIO_WritePin(SPI2_NSS_GPIO_Port, SPI2_NSS_Pin, GPIO_PIN_RESET);
 116              		.loc 1 82 5 is_stmt 1 view .LVU18
 117 0010 0E4F     		ldr	r7, .L12
 118 0012 0022     		movs	r2, #0
 119              	.LVL5:
 120              		.loc 1 82 5 is_stmt 0 view .LVU19
 121 0014 4FF48071 		mov	r1, #256
 122              	.LVL6:
 123              		.loc 1 82 5 view .LVU20
 124 0018 3846     		mov	r0, r7
 125              	.LVL7:
 126              		.loc 1 82 5 view .LVU21
 127 001a FFF7FEFF 		bl	HAL_GPIO_WritePin
 128              	.LVL8:
  83:Drivers/ESC/AX58100/esc_hw.c ****     // PB8 LOW
  84:Drivers/ESC/AX58100/esc_hw.c **** 
  85:Drivers/ESC/AX58100/esc_hw.c ****     /* Write address and command to device. */
  86:Drivers/ESC/AX58100/esc_hw.c ****     esc_address(address, ESC_CMD_READ);
 129              		.loc 1 86 5 is_stmt 1 view .LVU22
 130 001e 0221     		movs	r1, #2
 131 0020 3046     		mov	r0, r6
 132 0022 FFF7FEFF 		bl	esc_address
 133              	.LVL9:
  87:Drivers/ESC/AX58100/esc_hw.c **** 
  88:Drivers/ESC/AX58100/esc_hw.c ****     /* Here we want to read data and keep MOSI low (0x00) during
  89:Drivers/ESC/AX58100/esc_hw.c ****      * all bytes except the last one where we want to pull it high (0xFF).
  90:Drivers/ESC/AX58100/esc_hw.c ****      * Read (and write termination bytes).
  91:Drivers/ESC/AX58100/esc_hw.c ****      */
  92:Drivers/ESC/AX58100/esc_hw.c ****     HAL_SPI_TransmitReceive(&hspi2, read_termination + (MAX_READ_SIZE - len), buf, len, 100);
 134              		.loc 1 92 5 view .LVU23
 135              		.loc 1 92 71 is_stmt 0 view .LVU24
 136 0026 C4F18001 		rsb	r1, r4, #128
 137              		.loc 1 92 5 view .LVU25
 138 002a 6423     		movs	r3, #100
ARM GAS  /tmp/ccmcY0fn.s 			page 5


 139 002c 0093     		str	r3, [sp]
 140 002e 2346     		mov	r3, r4
 141 0030 2A46     		mov	r2, r5
 142 0032 0748     		ldr	r0, .L12+4
 143 0034 0144     		add	r1, r1, r0
 144 0036 0748     		ldr	r0, .L12+8
 145 0038 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 146              	.LVL10:
  93:Drivers/ESC/AX58100/esc_hw.c **** 
  94:Drivers/ESC/AX58100/esc_hw.c ****     /* Un-select device. */
  95:Drivers/ESC/AX58100/esc_hw.c ****     // spi_unselect(et1100);
  96:Drivers/ESC/AX58100/esc_hw.c ****     HAL_GPIO_WritePin(SPI2_NSS_GPIO_Port, SPI2_NSS_Pin, GPIO_PIN_SET);
 147              		.loc 1 96 5 is_stmt 1 view .LVU26
 148 003c 0122     		movs	r2, #1
 149 003e 4FF48071 		mov	r1, #256
 150 0042 3846     		mov	r0, r7
 151 0044 FFF7FEFF 		bl	HAL_GPIO_WritePin
 152              	.LVL11:
  97:Drivers/ESC/AX58100/esc_hw.c ****     // PB8 HIGH
  98:Drivers/ESC/AX58100/esc_hw.c **** }
 153              		.loc 1 98 1 is_stmt 0 view .LVU27
 154 0048 03B0     		add	sp, sp, #12
 155              		.cfi_def_cfa_offset 20
 156              		@ sp needed
 157 004a F0BD     		pop	{r4, r5, r6, r7, pc}
 158              	.LVL12:
 159              	.L13:
 160              		.loc 1 98 1 view .LVU28
 161              		.align	2
 162              	.L12:
 163 004c 00040240 		.word	1073873920
 164 0050 00000000 		.word	.LANCHOR0
 165 0054 00000000 		.word	hspi2
 166              		.cfi_endproc
 167              	.LFE131:
 169              		.section	.text.ESC_write,"ax",%progbits
 170              		.align	1
 171              		.global	ESC_write
 172              		.syntax unified
 173              		.thumb
 174              		.thumb_func
 176              	ESC_write:
 177              	.LVL13:
 178              	.LFB132:
  99:Drivers/ESC/AX58100/esc_hw.c **** 
 100:Drivers/ESC/AX58100/esc_hw.c **** /** ESC write function used by the Slave stack.
 101:Drivers/ESC/AX58100/esc_hw.c ****  *
 102:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   address     = address of ESC register to write
 103:Drivers/ESC/AX58100/esc_hw.c ****  * @param[out]  buf         = pointer to buffer to write from
 104:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   len         = number of bytes to write
 105:Drivers/ESC/AX58100/esc_hw.c ****  */
 106:Drivers/ESC/AX58100/esc_hw.c **** void ESC_write(uint16_t address, void *buf, uint16_t len)
 107:Drivers/ESC/AX58100/esc_hw.c **** {
 179              		.loc 1 107 1 is_stmt 1 view -0
 180              		.cfi_startproc
 181              		@ args = 0, pretend = 0, frame = 0
 182              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccmcY0fn.s 			page 6


 183              		.loc 1 107 1 is_stmt 0 view .LVU30
 184 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 185              		.cfi_def_cfa_offset 24
 186              		.cfi_offset 3, -24
 187              		.cfi_offset 4, -20
 188              		.cfi_offset 5, -16
 189              		.cfi_offset 6, -12
 190              		.cfi_offset 7, -8
 191              		.cfi_offset 14, -4
 192 0002 0646     		mov	r6, r0
 193 0004 0C46     		mov	r4, r1
 194 0006 1546     		mov	r5, r2
 108:Drivers/ESC/AX58100/esc_hw.c ****     /* Select device. */
 109:Drivers/ESC/AX58100/esc_hw.c ****     // spi_select (et1100);
 110:Drivers/ESC/AX58100/esc_hw.c ****     HAL_GPIO_WritePin(SPI2_NSS_GPIO_Port, SPI2_NSS_Pin, GPIO_PIN_RESET);
 195              		.loc 1 110 5 is_stmt 1 view .LVU31
 196 0008 0B4F     		ldr	r7, .L16
 197 000a 0022     		movs	r2, #0
 198              	.LVL14:
 199              		.loc 1 110 5 is_stmt 0 view .LVU32
 200 000c 4FF48071 		mov	r1, #256
 201              	.LVL15:
 202              		.loc 1 110 5 view .LVU33
 203 0010 3846     		mov	r0, r7
 204              	.LVL16:
 205              		.loc 1 110 5 view .LVU34
 206 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 207              	.LVL17:
 111:Drivers/ESC/AX58100/esc_hw.c ****     // PB8 LOW
 112:Drivers/ESC/AX58100/esc_hw.c **** 
 113:Drivers/ESC/AX58100/esc_hw.c ****     /* Write address and command to device. */
 114:Drivers/ESC/AX58100/esc_hw.c ****     esc_address(address, ESC_CMD_WRITE);
 208              		.loc 1 114 5 is_stmt 1 view .LVU35
 209 0016 0421     		movs	r1, #4
 210 0018 3046     		mov	r0, r6
 211 001a FFF7FEFF 		bl	esc_address
 212              	.LVL18:
 115:Drivers/ESC/AX58100/esc_hw.c ****     /* Write data. */
 116:Drivers/ESC/AX58100/esc_hw.c ****     HAL_SPI_Transmit(&hspi2, buf, len, 100);
 213              		.loc 1 116 5 view .LVU36
 214 001e 6423     		movs	r3, #100
 215 0020 2A46     		mov	r2, r5
 216 0022 2146     		mov	r1, r4
 217 0024 0548     		ldr	r0, .L16+4
 218 0026 FFF7FEFF 		bl	HAL_SPI_Transmit
 219              	.LVL19:
 117:Drivers/ESC/AX58100/esc_hw.c ****     /* Un-select device. */
 118:Drivers/ESC/AX58100/esc_hw.c ****     // spi_unselect(et1100);
 119:Drivers/ESC/AX58100/esc_hw.c ****     HAL_GPIO_WritePin(SPI2_NSS_GPIO_Port, SPI2_NSS_Pin, GPIO_PIN_SET);
 220              		.loc 1 119 5 view .LVU37
 221 002a 0122     		movs	r2, #1
 222 002c 4FF48071 		mov	r1, #256
 223 0030 3846     		mov	r0, r7
 224 0032 FFF7FEFF 		bl	HAL_GPIO_WritePin
 225              	.LVL20:
 120:Drivers/ESC/AX58100/esc_hw.c ****     // PB8 HIGH
 121:Drivers/ESC/AX58100/esc_hw.c **** }
ARM GAS  /tmp/ccmcY0fn.s 			page 7


 226              		.loc 1 121 1 is_stmt 0 view .LVU38
 227 0036 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 228              	.LVL21:
 229              	.L17:
 230              		.loc 1 121 1 view .LVU39
 231              		.align	2
 232              	.L16:
 233 0038 00040240 		.word	1073873920
 234 003c 00000000 		.word	hspi2
 235              		.cfi_endproc
 236              	.LFE132:
 238              		.section	.text.ESC_init,"ax",%progbits
 239              		.align	1
 240              		.global	ESC_init
 241              		.syntax unified
 242              		.thumb
 243              		.thumb_func
 245              	ESC_init:
 246              	.LVL22:
 247              	.LFB133:
 122:Drivers/ESC/AX58100/esc_hw.c **** 
 123:Drivers/ESC/AX58100/esc_hw.c **** // static void task_delay(uint32_t time_us)
 124:Drivers/ESC/AX58100/esc_hw.c **** //{
 125:Drivers/ESC/AX58100/esc_hw.c **** // #define DELAY_1_uS 168 // todo tweak to used clock speed
 126:Drivers/ESC/AX58100/esc_hw.c **** //     uint32_t delay_ticks = DELAY_1_uS * time_us;
 127:Drivers/ESC/AX58100/esc_hw.c **** //
 128:Drivers/ESC/AX58100/esc_hw.c **** //     for (int32_t i = 0; i < delay_ticks; ++i)
 129:Drivers/ESC/AX58100/esc_hw.c **** //     {
 130:Drivers/ESC/AX58100/esc_hw.c **** //         // do nothing
 131:Drivers/ESC/AX58100/esc_hw.c **** //     }
 132:Drivers/ESC/AX58100/esc_hw.c **** // }
 133:Drivers/ESC/AX58100/esc_hw.c **** 
 134:Drivers/ESC/AX58100/esc_hw.c **** // void ESC_reset(void)
 135:Drivers/ESC/AX58100/esc_hw.c **** //{
 136:Drivers/ESC/AX58100/esc_hw.c **** //     volatile uint32_t timeout;
 137:Drivers/ESC/AX58100/esc_hw.c **** //
 138:Drivers/ESC/AX58100/esc_hw.c **** //     DPRINT("esc_reset_started\n");
 139:Drivers/ESC/AX58100/esc_hw.c **** //
 140:Drivers/ESC/AX58100/esc_hw.c **** //     //rst_low();
 141:Drivers/ESC/AX58100/esc_hw.c **** //     task_delay(1000);
 142:Drivers/ESC/AX58100/esc_hw.c **** //
 143:Drivers/ESC/AX58100/esc_hw.c **** //     //rst_check_start();
 144:Drivers/ESC/AX58100/esc_hw.c **** //
 145:Drivers/ESC/AX58100/esc_hw.c **** //     while (timeout < 10000000)
 146:Drivers/ESC/AX58100/esc_hw.c **** //     {
 147:Drivers/ESC/AX58100/esc_hw.c **** //         /* ECAT releases resetpin, typically takes 40 us
 148:Drivers/ESC/AX58100/esc_hw.c **** //            Reset to operational PDI is max 70 ms */
 149:Drivers/ESC/AX58100/esc_hw.c **** //         if (is_esc_reset())
 150:Drivers/ESC/AX58100/esc_hw.c **** //         {
 151:Drivers/ESC/AX58100/esc_hw.c **** //             //rst_high();
 152:Drivers/ESC/AX58100/esc_hw.c **** //             break; // OK
 153:Drivers/ESC/AX58100/esc_hw.c **** //         }
 154:Drivers/ESC/AX58100/esc_hw.c **** //         timeout++;
 155:Drivers/ESC/AX58100/esc_hw.c **** //         task_delay(30);
 156:Drivers/ESC/AX58100/esc_hw.c **** //     }
 157:Drivers/ESC/AX58100/esc_hw.c **** //     DPRINT("esc_reset_ended\n");
 158:Drivers/ESC/AX58100/esc_hw.c **** // }
ARM GAS  /tmp/ccmcY0fn.s 			page 8


 159:Drivers/ESC/AX58100/esc_hw.c **** 
 160:Drivers/ESC/AX58100/esc_hw.c **** void ESC_init(const esc_cfg_t *config)
 161:Drivers/ESC/AX58100/esc_hw.c **** {
 248              		.loc 1 161 1 is_stmt 1 view -0
 249              		.cfi_startproc
 250              		@ args = 0, pretend = 0, frame = 0
 251              		@ frame_needed = 0, uses_anonymous_args = 0
 252              		@ link register save eliminated.
 162:Drivers/ESC/AX58100/esc_hw.c ****     // rst_setup();
 163:Drivers/ESC/AX58100/esc_hw.c ****     // rst_high();
 164:Drivers/ESC/AX58100/esc_hw.c ****     read_termination[MAX_READ_SIZE - 1] = 0xFF;
 253              		.loc 1 164 5 view .LVU41
 254              		.loc 1 164 41 is_stmt 0 view .LVU42
 255 0000 024B     		ldr	r3, .L19
 256 0002 FF22     		movs	r2, #255
 257 0004 83F87F20 		strb	r2, [r3, #127]
 165:Drivers/ESC/AX58100/esc_hw.c **** 
 166:Drivers/ESC/AX58100/esc_hw.c ****     // uint8_t device_symbol = 0;
 167:Drivers/ESC/AX58100/esc_hw.c ****     // while (device_symbol == 0)
 168:Drivers/ESC/AX58100/esc_hw.c ****     // {
 169:Drivers/ESC/AX58100/esc_hw.c ****     //    ESC_read(, (void *)&device_symbol, sizeof(uint8_t));
 170:Drivers/ESC/AX58100/esc_hw.c ****     //    if ((device_symbol != 0) || (device_symbol != 0xFF))
 171:Drivers/ESC/AX58100/esc_hw.c ****     //    {
 172:Drivers/ESC/AX58100/esc_hw.c ****     //       DPRINT("ESC init successful");
 173:Drivers/ESC/AX58100/esc_hw.c ****     //    }
 174:Drivers/ESC/AX58100/esc_hw.c ****     // }
 175:Drivers/ESC/AX58100/esc_hw.c ****     // task_delay(1000); // allow ESC to load EEPROM, or if EEP_DONE can be read
 176:Drivers/ESC/AX58100/esc_hw.c ****     // then wait while EEP_DONE is low.
 177:Drivers/ESC/AX58100/esc_hw.c **** }
 258              		.loc 1 177 1 view .LVU43
 259 0008 7047     		bx	lr
 260              	.L20:
 261 000a 00BF     		.align	2
 262              	.L19:
 263 000c 00000000 		.word	.LANCHOR0
 264              		.cfi_endproc
 265              	.LFE133:
 267              		.section	.text.ESC_interrupt_enable,"ax",%progbits
 268              		.align	1
 269              		.global	ESC_interrupt_enable
 270              		.syntax unified
 271              		.thumb
 272              		.thumb_func
 274              	ESC_interrupt_enable:
 275              	.LVL23:
 276              	.LFB134:
 178:Drivers/ESC/AX58100/esc_hw.c **** 
 179:Drivers/ESC/AX58100/esc_hw.c **** /** ESC interrupt enable function by the Slave stack in IRQ mode.
 180:Drivers/ESC/AX58100/esc_hw.c ****  *
 181:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   mask     = of interrupts to enable
 182:Drivers/ESC/AX58100/esc_hw.c ****  */
 183:Drivers/ESC/AX58100/esc_hw.c **** void ESC_interrupt_enable(uint32_t mask)
 184:Drivers/ESC/AX58100/esc_hw.c **** {
 277              		.loc 1 184 1 is_stmt 1 view -0
 278              		.cfi_startproc
 279              		@ args = 0, pretend = 0, frame = 0
 280              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccmcY0fn.s 			page 9


 281              		.loc 1 184 1 is_stmt 0 view .LVU45
 282 0000 10B5     		push	{r4, lr}
 283              		.cfi_def_cfa_offset 8
 284              		.cfi_offset 4, -8
 285              		.cfi_offset 14, -4
 286 0002 0446     		mov	r4, r0
 185:Drivers/ESC/AX58100/esc_hw.c ****     // PDI interrupt
 186:Drivers/ESC/AX58100/esc_hw.c **** 
 187:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_SYNC0 & mask)
 287              		.loc 1 187 5 is_stmt 1 view .LVU46
 288              		.loc 1 187 8 is_stmt 0 view .LVU47
 289 0004 10F0040F 		tst	r0, #4
 290 0008 01D0     		beq	.L22
 188:Drivers/ESC/AX58100/esc_hw.c ****     {
 189:Drivers/ESC/AX58100/esc_hw.c ****         mask &= ~ESCREG_ALEVENT_DC_SYNC0;
 291              		.loc 1 189 9 is_stmt 1 view .LVU48
 292              		.loc 1 189 14 is_stmt 0 view .LVU49
 293 000a 20F00404 		bic	r4, r0, #4
 294              	.LVL24:
 295              	.L22:
 190:Drivers/ESC/AX58100/esc_hw.c ****     }
 191:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_SYNC1 & mask)
 296              		.loc 1 191 5 is_stmt 1 view .LVU50
 192:Drivers/ESC/AX58100/esc_hw.c ****     {
 193:Drivers/ESC/AX58100/esc_hw.c ****         //    mask &= ~ESCREG_ALEVENT_DC_SYNC1;
 194:Drivers/ESC/AX58100/esc_hw.c ****     }
 297              		.loc 1 194 5 view .LVU51
 195:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_LATCH & mask)
 298              		.loc 1 195 5 view .LVU52
 196:Drivers/ESC/AX58100/esc_hw.c ****     {
 197:Drivers/ESC/AX58100/esc_hw.c ****         // mask &= ~ESCREG_ALEVENT_DC_LATCH;
 198:Drivers/ESC/AX58100/esc_hw.c ****     }
 299              		.loc 1 198 5 view .LVU53
 199:Drivers/ESC/AX58100/esc_hw.c **** 
 200:Drivers/ESC/AX58100/esc_hw.c ****     ESC_ALeventmaskwrite(ESC_ALeventmaskread() | mask);
 300              		.loc 1 200 5 view .LVU54
 301              		.loc 1 200 26 is_stmt 0 view .LVU55
 302 000e FFF7FEFF 		bl	ESC_ALeventmaskread
 303              	.LVL25:
 304              		.loc 1 200 5 view .LVU56
 305 0012 2043     		orrs	r0, r0, r4
 306 0014 FFF7FEFF 		bl	ESC_ALeventmaskwrite
 307              	.LVL26:
 201:Drivers/ESC/AX58100/esc_hw.c **** }
 308              		.loc 1 201 1 view .LVU57
 309 0018 10BD     		pop	{r4, pc}
 310              		.loc 1 201 1 view .LVU58
 311              		.cfi_endproc
 312              	.LFE134:
 314              		.section	.text.ESC_interrupt_disable,"ax",%progbits
 315              		.align	1
 316              		.global	ESC_interrupt_disable
 317              		.syntax unified
 318              		.thumb
 319              		.thumb_func
 321              	ESC_interrupt_disable:
 322              	.LVL27:
ARM GAS  /tmp/ccmcY0fn.s 			page 10


 323              	.LFB135:
 202:Drivers/ESC/AX58100/esc_hw.c **** 
 203:Drivers/ESC/AX58100/esc_hw.c **** /** ESC interrupt disable function by the Slave stack in IRQ mode.
 204:Drivers/ESC/AX58100/esc_hw.c ****  *
 205:Drivers/ESC/AX58100/esc_hw.c ****  * @param[in]   mask     = interrupts to disable
 206:Drivers/ESC/AX58100/esc_hw.c ****  */
 207:Drivers/ESC/AX58100/esc_hw.c **** void ESC_interrupt_disable(uint32_t mask)
 208:Drivers/ESC/AX58100/esc_hw.c **** {
 324              		.loc 1 208 1 is_stmt 1 view -0
 325              		.cfi_startproc
 326              		@ args = 0, pretend = 0, frame = 0
 327              		@ frame_needed = 0, uses_anonymous_args = 0
 328              		.loc 1 208 1 is_stmt 0 view .LVU60
 329 0000 10B5     		push	{r4, lr}
 330              		.cfi_def_cfa_offset 8
 331              		.cfi_offset 4, -8
 332              		.cfi_offset 14, -4
 333 0002 0446     		mov	r4, r0
 209:Drivers/ESC/AX58100/esc_hw.c ****     HAL_NVIC_DisableIRQ(EXTI9_5_IRQn);
 334              		.loc 1 209 5 is_stmt 1 view .LVU61
 335 0004 1720     		movs	r0, #23
 336              	.LVL28:
 337              		.loc 1 209 5 is_stmt 0 view .LVU62
 338 0006 FFF7FEFF 		bl	HAL_NVIC_DisableIRQ
 339              	.LVL29:
 210:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_SYNC0 & mask)
 340              		.loc 1 210 5 is_stmt 1 view .LVU63
 341              		.loc 1 210 8 is_stmt 0 view .LVU64
 342 000a 14F0040F 		tst	r4, #4
 343 000e 06D1     		bne	.L27
 344              	.L25:
 211:Drivers/ESC/AX58100/esc_hw.c ****     {
 212:Drivers/ESC/AX58100/esc_hw.c ****         HAL_NVIC_DisableIRQ(EXTI0_IRQn);
 213:Drivers/ESC/AX58100/esc_hw.c ****         mask &= ~ESCREG_ALEVENT_DC_SYNC0;
 214:Drivers/ESC/AX58100/esc_hw.c ****     }
 215:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_SYNC1 & mask)
 345              		.loc 1 215 5 is_stmt 1 view .LVU65
 216:Drivers/ESC/AX58100/esc_hw.c ****     {
 217:Drivers/ESC/AX58100/esc_hw.c ****         //    mask &= ~ESCREG_ALEVENT_DC_SYNC1;
 218:Drivers/ESC/AX58100/esc_hw.c ****     }
 346              		.loc 1 218 5 view .LVU66
 219:Drivers/ESC/AX58100/esc_hw.c ****     if (ESCREG_ALEVENT_DC_LATCH & mask)
 347              		.loc 1 219 5 view .LVU67
 220:Drivers/ESC/AX58100/esc_hw.c ****     {
 221:Drivers/ESC/AX58100/esc_hw.c ****         //    mask &= ~ESCREG_ALEVENT_DC_LATCH;
 222:Drivers/ESC/AX58100/esc_hw.c ****     }
 348              		.loc 1 222 5 view .LVU68
 223:Drivers/ESC/AX58100/esc_hw.c **** 
 224:Drivers/ESC/AX58100/esc_hw.c ****     ESC_ALeventmaskwrite(~mask & ESC_ALeventmaskread());
 349              		.loc 1 224 5 view .LVU69
 350              		.loc 1 224 26 is_stmt 0 view .LVU70
 351 0010 E443     		mvns	r4, r4
 352              	.LVL30:
 353              		.loc 1 224 34 view .LVU71
 354 0012 FFF7FEFF 		bl	ESC_ALeventmaskread
 355              	.LVL31:
 356              		.loc 1 224 5 view .LVU72
ARM GAS  /tmp/ccmcY0fn.s 			page 11


 357 0016 2040     		ands	r0, r0, r4
 358 0018 FFF7FEFF 		bl	ESC_ALeventmaskwrite
 359              	.LVL32:
 225:Drivers/ESC/AX58100/esc_hw.c **** }
 360              		.loc 1 225 1 view .LVU73
 361 001c 10BD     		pop	{r4, pc}
 362              	.LVL33:
 363              	.L27:
 212:Drivers/ESC/AX58100/esc_hw.c ****         mask &= ~ESCREG_ALEVENT_DC_SYNC0;
 364              		.loc 1 212 9 is_stmt 1 view .LVU74
 365 001e 0620     		movs	r0, #6
 366 0020 FFF7FEFF 		bl	HAL_NVIC_DisableIRQ
 367              	.LVL34:
 213:Drivers/ESC/AX58100/esc_hw.c ****     }
 368              		.loc 1 213 9 view .LVU75
 213:Drivers/ESC/AX58100/esc_hw.c ****     }
 369              		.loc 1 213 14 is_stmt 0 view .LVU76
 370 0024 24F00404 		bic	r4, r4, #4
 371              	.LVL35:
 213:Drivers/ESC/AX58100/esc_hw.c ****     }
 372              		.loc 1 213 14 view .LVU77
 373 0028 F2E7     		b	.L25
 374              		.cfi_endproc
 375              	.LFE135:
 377              		.section	.text.ESC_enable_DC,"ax",%progbits
 378              		.align	1
 379              		.global	ESC_enable_DC
 380              		.syntax unified
 381              		.thumb
 382              		.thumb_func
 384              	ESC_enable_DC:
 385              	.LFB136:
 226:Drivers/ESC/AX58100/esc_hw.c **** 
 227:Drivers/ESC/AX58100/esc_hw.c **** /** ESC enable Distributed Clocks (DC)
 228:Drivers/ESC/AX58100/esc_hw.c ****  *
 229:Drivers/ESC/AX58100/esc_hw.c ****  * @return  SYNC0 cycle time
 230:Drivers/ESC/AX58100/esc_hw.c ****  */
 231:Drivers/ESC/AX58100/esc_hw.c **** uint32_t ESC_enable_DC()
 232:Drivers/ESC/AX58100/esc_hw.c **** {
 386              		.loc 1 232 1 is_stmt 1 view -0
 387              		.cfi_startproc
 388              		@ args = 0, pretend = 0, frame = 16
 389              		@ frame_needed = 0, uses_anonymous_args = 0
 390 0000 10B5     		push	{r4, lr}
 391              		.cfi_def_cfa_offset 8
 392              		.cfi_offset 4, -8
 393              		.cfi_offset 14, -4
 394 0002 84B0     		sub	sp, sp, #16
 395              		.cfi_def_cfa_offset 24
 233:Drivers/ESC/AX58100/esc_hw.c ****     uint8_t data = 0x00;
 396              		.loc 1 233 5 view .LVU79
 397              		.loc 1 233 13 is_stmt 0 view .LVU80
 398 0004 0023     		movs	r3, #0
 399 0006 8DF80F30 		strb	r3, [sp, #15]
 234:Drivers/ESC/AX58100/esc_hw.c **** 
 235:Drivers/ESC/AX58100/esc_hw.c ****     // check DC Sync Out bit: 0x140:10
 236:Drivers/ESC/AX58100/esc_hw.c ****     ESC_read(ESCREG_ESC_CONFIG, &data, sizeof(data));
ARM GAS  /tmp/ccmcY0fn.s 			page 12


 400              		.loc 1 236 5 is_stmt 1 view .LVU81
 401 000a 0122     		movs	r2, #1
 402 000c 0DF10F01 		add	r1, sp, #15
 403 0010 40F24110 		movw	r0, #321
 404 0014 FFF7FEFF 		bl	ESC_read
 405              	.LVL36:
 237:Drivers/ESC/AX58100/esc_hw.c ****     if (!(data & DC_SYNC_OUT))
 406              		.loc 1 237 5 view .LVU82
 407              		.loc 1 237 16 is_stmt 0 view .LVU83
 408 0018 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 409              		.loc 1 237 8 view .LVU84
 410 001c 13F0040F 		tst	r3, #4
 411 0020 02D1     		bne	.L35
 238:Drivers/ESC/AX58100/esc_hw.c ****     {
 239:Drivers/ESC/AX58100/esc_hw.c ****         return 0; // DC sync is not enabled in ESI
 412              		.loc 1 239 16 view .LVU85
 413 0022 0020     		movs	r0, #0
 414              	.L28:
 240:Drivers/ESC/AX58100/esc_hw.c ****     }
 241:Drivers/ESC/AX58100/esc_hw.c **** 
 242:Drivers/ESC/AX58100/esc_hw.c ****     // read set SYNC0 Cycle Time from 0x09A0
 243:Drivers/ESC/AX58100/esc_hw.c ****     uint32_t setsync0cycleTime = 0;
 244:Drivers/ESC/AX58100/esc_hw.c ****     ESC_read(ESCREG_SYNC0_CYCLE_TIME, &setsync0cycleTime, sizeof(uint32_t));
 245:Drivers/ESC/AX58100/esc_hw.c ****     setsync0cycleTime = etohl(setsync0cycleTime);
 246:Drivers/ESC/AX58100/esc_hw.c **** 
 247:Drivers/ESC/AX58100/esc_hw.c ****     // check Sync Unit assign 0x0980:0 ( 0 for ECAT, 1 for PDI )
 248:Drivers/ESC/AX58100/esc_hw.c ****     ESC_read(ESCREG_CYCLIC_UNIT_CONTROL, &data, sizeof(data));
 249:Drivers/ESC/AX58100/esc_hw.c ****     if (data == SYNC_OUT_PDI_CONTROL)
 250:Drivers/ESC/AX58100/esc_hw.c ****     {
 251:Drivers/ESC/AX58100/esc_hw.c ****         // Sync Unit assigned to PDI, configuration needs to be finished by slave
 252:Drivers/ESC/AX58100/esc_hw.c **** 
 253:Drivers/ESC/AX58100/esc_hw.c ****         // set sync start time: read system time, add offset for writing start time and activation
 254:Drivers/ESC/AX58100/esc_hw.c ****         ESC_read(ESCREG_LOCALTIME, (void *)&ESCvar.Time, sizeof(ESCvar.Time));
 255:Drivers/ESC/AX58100/esc_hw.c ****         ESCvar.Time = etohl(ESCvar.Time);
 256:Drivers/ESC/AX58100/esc_hw.c ****         uint32_t startTime = ESCvar.Time + SYNC_START_OFFSET;
 257:Drivers/ESC/AX58100/esc_hw.c **** 
 258:Drivers/ESC/AX58100/esc_hw.c ****         ESC_write(ESCREG_SYNC_START_TIME, &startTime, sizeof(startTime));
 259:Drivers/ESC/AX58100/esc_hw.c **** 
 260:Drivers/ESC/AX58100/esc_hw.c ****         // activate cyclic operation and SYNC0
 261:Drivers/ESC/AX58100/esc_hw.c ****         ESC_read(ESCREG_SYNC_ACT, &data, sizeof(data));
 262:Drivers/ESC/AX58100/esc_hw.c ****         data = data | ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN;
 263:Drivers/ESC/AX58100/esc_hw.c ****         ESC_write(ESCREG_SYNC_ACT, &data, sizeof(data));
 264:Drivers/ESC/AX58100/esc_hw.c ****         data = 0x00;
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 266:Drivers/ESC/AX58100/esc_hw.c ****         {
 267:Drivers/ESC/AX58100/esc_hw.c ****             ESC_read(ESCREG_SYNC_ACT, &data, sizeof(data));
 268:Drivers/ESC/AX58100/esc_hw.c ****         }
 269:Drivers/ESC/AX58100/esc_hw.c ****     }
 270:Drivers/ESC/AX58100/esc_hw.c **** 
 271:Drivers/ESC/AX58100/esc_hw.c ****     return setsync0cycleTime;
 272:Drivers/ESC/AX58100/esc_hw.c **** }...
 415              		.loc 1 272 1 view .LVU86
 416 0024 04B0     		add	sp, sp, #16
 417              		.cfi_remember_state
 418              		.cfi_def_cfa_offset 8
 419              		@ sp needed
 420 0026 10BD     		pop	{r4, pc}
ARM GAS  /tmp/ccmcY0fn.s 			page 13


 421              	.L35:
 422              		.cfi_restore_state
 243:Drivers/ESC/AX58100/esc_hw.c ****     uint32_t setsync0cycleTime = 0;
 423              		.loc 1 243 5 is_stmt 1 view .LVU87
 243:Drivers/ESC/AX58100/esc_hw.c ****     uint32_t setsync0cycleTime = 0;
 424              		.loc 1 243 14 is_stmt 0 view .LVU88
 425 0028 0023     		movs	r3, #0
 426 002a 0293     		str	r3, [sp, #8]
 244:Drivers/ESC/AX58100/esc_hw.c ****     ESC_read(ESCREG_SYNC0_CYCLE_TIME, &setsync0cycleTime, sizeof(uint32_t));
 427              		.loc 1 244 5 is_stmt 1 view .LVU89
 428 002c 0422     		movs	r2, #4
 429 002e 02A9     		add	r1, sp, #8
 430 0030 4FF41A60 		mov	r0, #2464
 431 0034 FFF7FEFF 		bl	ESC_read
 432              	.LVL37:
 245:Drivers/ESC/AX58100/esc_hw.c ****     setsync0cycleTime = etohl(setsync0cycleTime);
 433              		.loc 1 245 5 view .LVU90
 248:Drivers/ESC/AX58100/esc_hw.c ****     ESC_read(ESCREG_CYCLIC_UNIT_CONTROL, &data, sizeof(data));
 434              		.loc 1 248 5 view .LVU91
 435 0038 0122     		movs	r2, #1
 436 003a 0DF10F01 		add	r1, sp, #15
 437 003e 4FF41860 		mov	r0, #2432
 438 0042 FFF7FEFF 		bl	ESC_read
 439              	.LVL38:
 249:Drivers/ESC/AX58100/esc_hw.c ****     if (data == SYNC_OUT_PDI_CONTROL)
 440              		.loc 1 249 5 view .LVU92
 249:Drivers/ESC/AX58100/esc_hw.c ****     if (data == SYNC_OUT_PDI_CONTROL)
 441              		.loc 1 249 14 is_stmt 0 view .LVU93
 442 0046 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 249:Drivers/ESC/AX58100/esc_hw.c ****     if (data == SYNC_OUT_PDI_CONTROL)
 443              		.loc 1 249 8 view .LVU94
 444 004a 012B     		cmp	r3, #1
 445 004c 01D0     		beq	.L36
 446              	.L30:
 271:Drivers/ESC/AX58100/esc_hw.c ****     return setsync0cycleTime;
 447              		.loc 1 271 5 is_stmt 1 view .LVU95
 271:Drivers/ESC/AX58100/esc_hw.c ****     return setsync0cycleTime;
 448              		.loc 1 271 12 is_stmt 0 view .LVU96
 449 004e 0298     		ldr	r0, [sp, #8]
 450 0050 E8E7     		b	.L28
 451              	.L36:
 452              	.LBB2:
 254:Drivers/ESC/AX58100/esc_hw.c ****         ESC_read(ESCREG_LOCALTIME, (void *)&ESCvar.Time, sizeof(ESCvar.Time));
 453              		.loc 1 254 9 is_stmt 1 view .LVU97
 454 0052 1E4C     		ldr	r4, .L37
 455 0054 0422     		movs	r2, #4
 456 0056 2146     		mov	r1, r4
 457 0058 4FF41160 		mov	r0, #2320
 458 005c FFF7FEFF 		bl	ESC_read
 459              	.LVL39:
 255:Drivers/ESC/AX58100/esc_hw.c ****         ESCvar.Time = etohl(ESCvar.Time);
 460              		.loc 1 255 9 view .LVU98
 255:Drivers/ESC/AX58100/esc_hw.c ****         ESCvar.Time = etohl(ESCvar.Time);
 461              		.loc 1 255 23 is_stmt 0 view .LVU99
 462 0060 2146     		mov	r1, r4
 463 0062 51F8D839 		ldr	r3, [r1], #-216
 255:Drivers/ESC/AX58100/esc_hw.c ****         ESCvar.Time = etohl(ESCvar.Time);
ARM GAS  /tmp/ccmcY0fn.s 			page 14


 464              		.loc 1 255 21 view .LVU100
 465 0066 C1F8D830 		str	r3, [r1, #216]
 256:Drivers/ESC/AX58100/esc_hw.c ****         uint32_t startTime = ESCvar.Time + SYNC_START_OFFSET;
 466              		.loc 1 256 9 is_stmt 1 view .LVU101
 256:Drivers/ESC/AX58100/esc_hw.c ****         uint32_t startTime = ESCvar.Time + SYNC_START_OFFSET;
 467              		.loc 1 256 36 is_stmt 0 view .LVU102
 468 006a D1F8D820 		ldr	r2, [r1, #216]
 256:Drivers/ESC/AX58100/esc_hw.c ****         uint32_t startTime = ESCvar.Time + SYNC_START_OFFSET;
 469              		.loc 1 256 42 view .LVU103
 470 006e 184B     		ldr	r3, .L37+4
 471 0070 1344     		add	r3, r3, r2
 256:Drivers/ESC/AX58100/esc_hw.c ****         uint32_t startTime = ESCvar.Time + SYNC_START_OFFSET;
 472              		.loc 1 256 18 view .LVU104
 473 0072 0193     		str	r3, [sp, #4]
 258:Drivers/ESC/AX58100/esc_hw.c ****         ESC_write(ESCREG_SYNC_START_TIME, &startTime, sizeof(startTime));
 474              		.loc 1 258 9 is_stmt 1 view .LVU105
 475 0074 0422     		movs	r2, #4
 476 0076 0DEB0201 		add	r1, sp, r2
 477 007a 4FF41960 		mov	r0, #2448
 478 007e FFF7FEFF 		bl	ESC_write
 479              	.LVL40:
 261:Drivers/ESC/AX58100/esc_hw.c ****         ESC_read(ESCREG_SYNC_ACT, &data, sizeof(data));
 480              		.loc 1 261 9 view .LVU106
 481 0082 0122     		movs	r2, #1
 482 0084 0DF10F01 		add	r1, sp, #15
 483 0088 40F68110 		movw	r0, #2433
 484 008c FFF7FEFF 		bl	ESC_read
 485              	.LVL41:
 262:Drivers/ESC/AX58100/esc_hw.c ****         data = data | ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN;
 486              		.loc 1 262 9 view .LVU107
 262:Drivers/ESC/AX58100/esc_hw.c ****         data = data | ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN;
 487              		.loc 1 262 14 is_stmt 0 view .LVU108
 488 0090 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 489 0094 43F00303 		orr	r3, r3, #3
 490 0098 8DF80F30 		strb	r3, [sp, #15]
 263:Drivers/ESC/AX58100/esc_hw.c ****         ESC_write(ESCREG_SYNC_ACT, &data, sizeof(data));
 491              		.loc 1 263 9 is_stmt 1 view .LVU109
 492 009c 0122     		movs	r2, #1
 493 009e 0DF10F01 		add	r1, sp, #15
 494 00a2 40F68110 		movw	r0, #2433
 495 00a6 FFF7FEFF 		bl	ESC_write
 496              	.LVL42:
 264:Drivers/ESC/AX58100/esc_hw.c ****         data = 0x00;
 497              		.loc 1 264 9 view .LVU110
 264:Drivers/ESC/AX58100/esc_hw.c ****         data = 0x00;
 498              		.loc 1 264 14 is_stmt 0 view .LVU111
 499 00aa 0023     		movs	r3, #0
 500 00ac 8DF80F30 		strb	r3, [sp, #15]
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 501              		.loc 1 265 9 is_stmt 1 view .LVU112
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 502              		.loc 1 265 15 is_stmt 0 view .LVU113
 503 00b0 06E0     		b	.L31
 504              	.L32:
 267:Drivers/ESC/AX58100/esc_hw.c ****             ESC_read(ESCREG_SYNC_ACT, &data, sizeof(data));
 505              		.loc 1 267 13 is_stmt 1 view .LVU114
 506 00b2 0122     		movs	r2, #1
ARM GAS  /tmp/ccmcY0fn.s 			page 15


 507 00b4 0DF10F01 		add	r1, sp, #15
 508 00b8 40F68110 		movw	r0, #2433
 509 00bc FFF7FEFF 		bl	ESC_read
 510              	.LVL43:
 511              	.L31:
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 512              		.loc 1 265 15 view .LVU115
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 513              		.loc 1 265 23 is_stmt 0 view .LVU116
 514 00c0 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 265:Drivers/ESC/AX58100/esc_hw.c ****         while (!(data & (ESCREG_SYNC_ACT_ACTIVATED | ESCREG_SYNC_SYNC0_EN)))
 515              		.loc 1 265 15 view .LVU117
 516 00c4 13F0030F 		tst	r3, #3
 517 00c8 F3D0     		beq	.L32
 518 00ca C0E7     		b	.L30
 519              	.L38:
 520              		.align	2
 521              	.L37:
 522 00cc D8000000 		.word	ESCvar+216
 523 00d0 B8BF2300 		.word	2342840
 524              	.LBE2:
 525              		.cfi_endproc
 526              	.LFE136:
 528              		.section	.bss.pdi_dma_transmission,"aw",%nobits
 531              	pdi_dma_transmission:
 532 0000 00       		.space	1
 533              		.section	.bss.read_termination,"aw",%nobits
 534              		.align	2
 535              		.set	.LANCHOR0,. + 0
 538              	read_termination:
 539 0000 00000000 		.space	128
 539      00000000 
 539      00000000 
 539      00000000 
 539      00000000 
 540              		.text
 541              	.Letext0:
 542              		.file 2 "/usr/share/gcc-arm-none-eabi-10.3-2021.10/lib/gcc/arm-none-eabi/10.3.1/include/stddef.h"
 543              		.file 3 "/usr/share/gcc-arm-none-eabi-10.3-2021.10/arm-none-eabi/include/machine/_default_types.h"
 544              		.file 4 "/usr/share/gcc-arm-none-eabi-10.3-2021.10/arm-none-eabi/include/sys/_stdint.h"
 545              		.file 5 "Drivers/SOES/Inc/esc.h"
 546              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 547              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 548              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 549              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 550              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 551              		.file 11 "Core/Inc/pdo_override.h"
 552              		.file 12 "Core/Inc/main.h"
 553              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_cortex.h"
ARM GAS  /tmp/ccmcY0fn.s 			page 16


DEFINED SYMBOLS
                            *ABS*:0000000000000000 esc_hw.c
     /tmp/ccmcY0fn.s:20     .text.esc_address:0000000000000000 $t
     /tmp/ccmcY0fn.s:25     .text.esc_address:0000000000000000 esc_address
     /tmp/ccmcY0fn.s:78     .text.esc_address:0000000000000034 $d
     /tmp/ccmcY0fn.s:84     .text.ESC_read:0000000000000000 $t
     /tmp/ccmcY0fn.s:90     .text.ESC_read:0000000000000000 ESC_read
     /tmp/ccmcY0fn.s:163    .text.ESC_read:000000000000004c $d
     /tmp/ccmcY0fn.s:170    .text.ESC_write:0000000000000000 $t
     /tmp/ccmcY0fn.s:176    .text.ESC_write:0000000000000000 ESC_write
     /tmp/ccmcY0fn.s:233    .text.ESC_write:0000000000000038 $d
     /tmp/ccmcY0fn.s:239    .text.ESC_init:0000000000000000 $t
     /tmp/ccmcY0fn.s:245    .text.ESC_init:0000000000000000 ESC_init
     /tmp/ccmcY0fn.s:263    .text.ESC_init:000000000000000c $d
     /tmp/ccmcY0fn.s:268    .text.ESC_interrupt_enable:0000000000000000 $t
     /tmp/ccmcY0fn.s:274    .text.ESC_interrupt_enable:0000000000000000 ESC_interrupt_enable
     /tmp/ccmcY0fn.s:315    .text.ESC_interrupt_disable:0000000000000000 $t
     /tmp/ccmcY0fn.s:321    .text.ESC_interrupt_disable:0000000000000000 ESC_interrupt_disable
     /tmp/ccmcY0fn.s:378    .text.ESC_enable_DC:0000000000000000 $t
     /tmp/ccmcY0fn.s:384    .text.ESC_enable_DC:0000000000000000 ESC_enable_DC
     /tmp/ccmcY0fn.s:522    .text.ESC_enable_DC:00000000000000cc $d
     /tmp/ccmcY0fn.s:531    .bss.pdi_dma_transmission:0000000000000000 pdi_dma_transmission
     /tmp/ccmcY0fn.s:532    .bss.pdi_dma_transmission:0000000000000000 $d
     /tmp/ccmcY0fn.s:534    .bss.read_termination:0000000000000000 $d
     /tmp/ccmcY0fn.s:538    .bss.read_termination:0000000000000000 read_termination

UNDEFINED SYMBOLS
HAL_SPI_TransmitReceive
ESCvar
hspi2
HAL_GPIO_WritePin
HAL_SPI_Transmit
ESC_ALeventmaskread
ESC_ALeventmaskwrite
HAL_NVIC_DisableIRQ
